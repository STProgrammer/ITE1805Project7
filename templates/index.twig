<!DOCTYPE html>
<html>
  <head>
		<link type="text/css" rel="stylesheet" href="stylesheet.css" />
        <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
      <title>
          File archive - showing files from the database
      </title>
  </head>
  <!-- Denne Javascript koden er modifisert fra https://stackoverflow.com/questions/5413899/search-and-replace-specific-query-string-parameter-value-in-javascript-->
  <body>
      {% include 'login2.twig' %}
      <div class = "content">
          {% if session.getFlashBag.has('header') %}
      <div class="flash-notice">
          {% for header in session.getFlashBag.get('header', []) %}
          <h3>{{ header }}</h3>
          {% endfor %}
          {% for message in session.getFlashBag.get('message', []) %}
              <p>{{ message }}</p>
              <p><a href = "./">Back </a></p>
          {% endfor %}
          {% else %}
      </div>
              <div class="search">
{#              <p>Today's date is: {{ object.date|date("Y-m-d") }}</p>#}
      <table id="search_form">
          <tr>
              <td>
                  <form method = "get">
                      <input type="search" name="query" placeholder="Search" maxlength="45">
                      <br>Uploaded date:
                      <br><label for="start">From date:</label>
                      <br><input type="date" id="from date" name="from-date"
                                 value=""
                                 min="2020-03-01" max="">
                      <br><label for="start">To date:</label>
                      <br><input type="date" id="to date" name="to-date"
                                 value=""
                                 min="2020-03-01" max="">
                      <br><button type="submit" name="search" value="search">Search</button></form>
              </td>
              <td>
                  <form method = "get">
                      <br><input type="text" name="tags" data-role="tagsinput" placeholder="tag1,tag2,tag3">
                      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
                      <script src="http://bootstrap-tagsinput.github.io/bootstrap-tagsinput/dist/bootstrap-tagsinput.min.js"></script>
                      <button type="submit" name="search" value="tagssearch">Search by tags</button>
                      <br><input type="checkbox" name="andcondition" value="1">
                      Check if you want each file to include all tags (AND condition)</form>
              </td>
          </tr>
      </table>
              </div>
          <h1>
              Project 7 Drive
          </h1>
          <div class="overview">
              <p><a href="{{rel}}file-upload/" class="button_white">Upload File</a> <a href="{{rel}}new-catalog/" class="button_white">New Catalog</a>  </p>
              <h2>
                  Catalog path: {{ catalogPath }}
              </h2>
          <div class="file-list">
  {% if elements %}
              {% for element in elements %}
                  {% if element.isFile == 0 %}
                      <div class="element_box">
                          <a href="{{rel}}?catalogid={{element.id}}"><img src="Images/iconfinder_Blank-Catalog_33986.png"/></a>
                          <br><a href="{{rel}}?catalogid={{element.id}}"> {{element.Title}} </a>
                          <br>Type: {{ element.Type }}
                          <br>Upload Date: {{ element.Date }}
                          <br>Author: <a href="profile-page/?username={{ element.Author }}">{{ element.Author }}</a>
                          <br><a href={{rel}}catalog/?id={{element.id}}>Details</a>
                      </div>
                      {% else %}
                    <div class="element_box">
                              {% if element.Type == 'image/jpeg' or  element.Type == 'image/pjpeg' or element.Type == 'image/png' or element.Type == 'image/gif'%}
                              <a href="{{rel}}?id={{element.id}}"><img src="{{rel}}thumbnail.php?id={{element.id}}"/></a>
                              {% elseif element.Type == 'application/msword' or element.Type == 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' %}
                              <a href="{{rel}}?id={{element.id}}"><img src=Images/iconfinder_word_272702.png"/></a>
                              {% elseif element.Type == 'application/mspowerpoint' %}
                               a href="{{rel}}?id={{element.id}}"><img src="Images/iconfinder_powerpoint_272700.png"/></a>
                              {% elseif element.Type == 'application/vnd.ms-excel' or element.Type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' %}
                              <a href="{{rel}}?id={{element.id}}"><img src="Images/iconfinder_excel_272697.png"/></a>
                              {% elseif element.Type == 'application/pdf' %}
                              <a href="{{rel}}?id={{element.id}}"><img src="Images/iconfinder_pdf_272699.png"/></a>
                              {% elseif element.Type == 'text/plain' %}
                              <a href="{{rel}}?id={{element.id}}"><img src="Images/iconfinder_text_272701.png"/></a>
                              {% elseif element.Type == 'video/mp4' or element.Type == 'video/webm' or element.Type == 'video/ogg' %}
                              <a href="{{rel}}?id={{element.id}}"><img src="Images/iconfinder_video-alt_383195.png"/></a>
                              {% else %}
                              <a href="{{rel}}?id={{element.id}}"><img src="Images/iconfinder_File_104851.png"/></a>
                              {% endif %}
                              <br><a href="{{rel}}?id={{element.id}}"> {{element.Title}} </a>
                              <br>Type: {{ element.Type }}
                              <br>Upload Date: {{ element.Date }}
                              <br>Author: {{ element.Author }}
                              <br>Views: {{ element.Views }}
                              <br><a href={{rel}}file-details/?id={{element.id}}>Details</a>
                          </div>
                      {% endif %}
              {% endfor %}
              {% else %}
              <h3>No elements found</h3>
      </div>
  {% endif %}
  </div>
      </div>
              {% if pagination|length > 1 %} <div class="pagination">
                  {% for page in pagination %}
                  {% if request.query.get('pageno') == page
                      or not request.query.has('pageno') and page == 1%} {{ page }}
                      {% else %} <a href="{{ get_page_url({ 'pageno': page, }) }}" class = "button_white button_pagination">{{ page }}</a>
                      {% endif %}
                  {% endfor %}
              </div>
          {% endif %}
      {% endif %}
  </body>
</html>
